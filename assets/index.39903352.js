var F=Object.defineProperty;var k=(l,e,i)=>e in l?F(l,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[e]=i;var p=(l,e,i)=>(k(l,typeof e!="symbol"?e+"":e,i),i);import{j as C,r as E,R as O,a as B}from"./vendor.74de5323.js";const D=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function i(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=i(n);fetch(n.href,r)}};D();const t=C.exports.jsx,u=C.exports.jsxs;function R(l,e,i){let s=[];for(let n=0;n<9;n++)s[n]=l.areas.slice(n*9,n*9+9).map(r=>{let c="#ccc",d=r.id;switch(e){case h.Terrain:c=r.terrain.color;break;case h.Ruler:c=l.rulerOf(r).color;break;case h.Country:c=l.topRulerOf(r).color;break;case h.Culture:c=l.rulerOf(r).color,d=r.culture;break;case h.Faith:c=l.rulerOf(r).color,d=r.faith;break;case h.Development:c=l.rulerOf(r).color,d=r.development.toString();break}return{area:r,color:c,text:d}});return t("div",{className:"MainMap",children:s.map((n,r)=>t("div",{children:n.map(c=>t("span",{className:"MainMap-cell",onClick:()=>i(c.area),style:{backgroundColor:c.color},children:t("span",{className:"MainMap-cell-inner",children:c.text})},c.area.id))},r))})}function T(l,e){return u("div",{className:"CharacterDetail",children:[u("div",{children:[u("span",{children:["",""," ",e.name]}),u("span",{className:"age",children:[e.age,"\u6B73"]}),t("span",{className:"health",children:"\u2764"})]}),u("div",{children:[t("span",{className:"relation",children:"\u96A3\u56FD\u306E\u9818\u4E3B"}),t("span",{className:"sexuality",children:"\u2642\u2640"})]}),t("div",{className:"traits",children:e.traits.map(n=>t("span",{className:"trait",children:t("span",{children:n})}))}),u("div",{children:[u("div",{className:"capability",children:[u("div",{className:"capability-column",children:[t("div",{children:"\u5916\u4EA4"}),t("div",{children:e.diplomacy})]}),u("div",{className:"capability-column",children:[t("div",{children:"\u8ECD\u4E8B"}),t("div",{children:e.martial})]}),u("div",{className:"capability-column",children:[t("div",{children:"\u7BA1\u7406"}),t("div",{children:e.stewardship})]}),u("div",{className:"capability-column",children:[t("div",{children:"\u7B56\u8B00"}),t("div",{children:e.intrigue})]}),u("div",{className:"capability-column",children:[t("div",{children:"\u5B66\u8B58"}),t("div",{children:e.learning})]}),u("div",{className:"capability-column",children:[t("div",{children:"\u6B66\u52C7"}),t("div",{children:e.prowness})]})]}),u("div",{className:"personal",children:[t("div",{children:e.faith}),t("div",{children:e.culture}),t("div",{children:e.house})]})]}),t("div",{children:u("div",{className:"asset",children:[u("div",{className:"asset-column",children:[t("div",{children:"\u6050\u6016"}),t("div",{children:0})]}),u("div",{className:"asset-column",children:[t("div",{children:"\u8CC7\u91D1"}),t("div",{children:0})]}),u("div",{className:"asset-column",children:[t("div",{children:"\u540D\u58F0"}),t("div",{children:0})]}),u("div",{className:"asset-column",children:[t("div",{children:"\u732E\u8EAB"}),t("div",{children:0})]}),u("div",{className:"asset-column",children:[t("div",{children:"\u5175\u6570"}),t("div",{children:e.getTotalSoldiers(l)})]})]})})]})}var h;(function(l){l[l.Terrain=0]="Terrain",l[l.Ruler=1]="Ruler",l[l.Country=2]="Country",l[l.Culture=3]="Culture",l[l.Faith=4]="Faith",l[l.Development=5]="Development"})(h||(h={}));function I({core:l}){const[e,i]=E.exports.useState(1),[s,n]=E.exports.useState(null);function r(c){let d=l.rulerOf(c);n(d)}return u("div",{className:"App",children:[R(l,e,r),s&&T(l,s),u("div",{children:[u("h3",{children:["\u30DE\u30C3\u30D7\u5207\u308A\u66FF\u3048\uFF08\u73FE\u5728: ",e,"\uFF09"]}),u("div",{children:[t("button",{onClick:()=>i(0),children:"\u5730\u5F62"}),t("button",{onClick:()=>i(1),children:"\u9818\u4E3B"}),t("button",{onClick:()=>i(2),children:"\u56FD"}),t("button",{onClick:()=>i(3),children:"\u6587\u5316"}),t("button",{onClick:()=>i(4),children:"\u4FE1\u4EF0"}),t("button",{onClick:()=>i(5),children:"\u958B\u767A\u5EA6"})]})]})]})}class S{constructor(e,i,s,n,r){this.id=e,this.terrain=i,this.culture=s,this.faith=n,this.development=r}}class j{constructor(e,i,s,n,r,c,d,a,o,f,w,y,N,b,g,x,A){this.id=e,this.name=i,this.color=s,this.master=n,this.titles=r,this.age=c,this.diplomacy=d,this.martial=a,this.stewardship=o,this.intrigue=f,this.learning=w,this.prowness=y,this.traits=N,this.perkCount=b,this.culture=g,this.faith=x,this.house=A}getTotalSoldiers(e){let i=0;this.titles.forEach(n=>{i+=n.development*100}),e.characters.forEach(n=>{n.master===this&&n.titles.forEach(r=>{r.development*100*.1})});var s=1;return this.master!=null&&(s*=.9),s*=1+(this.martial-5)*2/100,Math.floor(i*s)}}const m=class{constructor(e,i){this.name=e,this.color=i}static of(e){return this.terrains[e]}};let v=m;p(v,"terrains",{\u967A\u3057\u3044\u5C71:new m("\u967A\u3057\u3044\u5C71","#888"),\u5C71:new m("\u5C71","#801"),\u4E18\u9675:new m("\u4E18\u9675","#b85"),\u5E73\u91CE:new m("\u5E73\u91CE","#eea"),\u68EE:new m("\u68EE","#040"),\u6E7F\u5730:new m("\u6E7F\u5730","#08a")});async function L(){let e=await(await fetch("Areas.csv")).text(),[i,...s]=e.split(`
`);return s.map(n=>{let r=n.trim().split(",");return new S(r[0],v.of(r[1]),r[2],r[3],parseInt(r[4]))})}async function $(l){let i=await(await fetch("Characters.csv")).text(),[s,...n]=i.trim().split(`
`),r={},c=n.map(d=>{let a=d.trim().split(",");return r[a[0]]=a[3],console.log(a),new j(a[0],a[1],a[2],null,a[4].split(" ").filter(o=>o!=="").map(o=>l.areaOf(o)),parseInt(a[5]),parseInt(a[6]),parseInt(a[7]),parseInt(a[8]),parseInt(a[9]),parseInt(a[10]),parseInt(a[11]),[a[12],...a[13].split(" "),...a[14].split(" "),...a[15].split(" ")].filter(o=>o!==""),parseInt(a[16]),a[17],a[18],a[19])});return c.forEach(d=>{let a=r[d.id],o=c.find(f=>f.name===a);d.master=o!=null?o:null}),c}class z{constructor(){p(this,"areas");p(this,"characters")}areaOf(e){let i=this.areas.find(s=>s.id===e);if(i==null)throw new Error(`${e} not found`);return i}rulerOf(e){let i=this.characters.find(s=>s.titles.indexOf(e)>=0);if(i==null)throw new Error(`${e.id}'s ruler not found`);return i}topRulerOf(e){let i=this.rulerOf(e);for(;i.master!=null;)i=i.master;return i}characterOf(e){let i=this.characters.find(s=>s.id===e);if(i==null)throw new Error(`${e} not found`);return i}async initialize(){this.areas=await L(),this.characters=await $(this)}}(async function(){let l=new z;await l.initialize(),O.render(t(B.StrictMode,{children:t(I,{core:l})}),document.getElementById("root"))})();
